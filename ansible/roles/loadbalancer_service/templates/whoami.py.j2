#!/usr/bin/env python3
import http.server
import socketserver
import sys

PORT = 8080

class Handler(http.server.BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-type', 'text/plain')
        self.end_headers()
        self.wfile.write(b"WhoAmI Demo Service\n")
        self.wfile.write(b"=================\n")
        self.wfile.write(f"Client: {self.client_address}\n".encode())
        self.wfile.write(b"\nRequest Headers:\n")
        for key, value in self.headers.items():
            self.wfile.write(f"{key}: {value}\n".encode())

if __name__ == "__main__":
    try:
        with socketserver.TCPServer(("", PORT), Handler) as httpd:
            print(f"Serving at port {PORT}")
            httpd.serve_forever()
    except KeyboardInterrupt:
        sys.exit(0)
